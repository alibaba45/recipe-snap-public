Changelog:
2024-05-26
feat(data): Refactor Recipe data model and local DB for separate DNA storage
- Centralized Recipe, Ingredient, Nutrition types in `types/index.ts`.
- Updated `Recipe` type to include `recipeDNADetailId`, `userNutritionInput`, `recipeType`, `status`, denormalized AI fields (`aiAnalyzedTitle` object, `aiConceptualTags`, `aiOverallSummarySnapshot`), `usedSignatureElementIds`, and element-specific attributes (`baseDishCompatibility`, `elementInsertionPoints`).
- Refactored `lib/db.ts` (IndexedDB):
    - Added `recipeDNADetails` object store (DB_VERSION 3).
    - `saveRecipe` now handles saving main Recipe data and associated RecipeDNADetail to separate stores, and populates denormalized fields on the main Recipe object.
    - `getRecipeById` now fetches and combines Recipe and its linked RecipeDNADetail.
    - `deleteRecipe` now deletes from both stores.
    - Added standalone methods for `saveRecipeDNADetail`, `getRecipeDNADetailById`, `deleteRecipeDNADetailById`.
- Updated `recipeRepository.ts` (`saveRecipe`):
    - Signature now accepts `associatedDna?: RecipeDNADetail | null`.
    - Logic added to populate denormalized AI fields and generate `searchableTags` on the Recipe object before local save.
    - Prepared for separate Firestore DNA saving (though Firestore part deferred for DNA itself).
feat(ui): Enhance Recipe display and editing for new data fields
- Updated `RecipeList.tsx` and `RecipeDetail.tsx` to display `searchableTags`.
- Enhanced `RecipeDetail.tsx` to display new `Recipe` fields: description, AI overview, user-entered nutrition, recipe type, status, preparation notes, and element-specific details.
- Updated `RecipeEdit.tsx`:
    - Added UI form fields for `userNutritionInput`.
    - Refined `useEffect` for `initialRecipeData` to correctly handle various data types.
    - Corrected `handleSubmit` to populate `Recipe.aiAnalyzedTitle` with the full `AnalyzedTitleObject` and correctly package `userNutritionInput`.
fix(ui): Resolved `capitalizeTag is not defined` runtime error in display components.
chore(types): Standardized ID types (e.g., `UserSavedSignatureElementInfo.id` to `number`).

2024-05-23-2024-05-24

### Features & Enhancements:
- **AI DNA Generation V2:**
  - Implemented structured title analysis within `RecipeDNADetail`, outputting `aiAnalyzedTitle` as an object with `originalUserTitle`, `titleString`, `mainDishComponent`, `methodStyle`, and `adjective`.
  - Enhanced `annotatedPreparationSteps` in `RecipeDNADetail` to include structured fields: `actions`, `ingredientsMentioned`, `toolsMentioned`, `duration`, and `temperature`.
  - AI prompts for DNA generation significantly refined for accuracy in `annotatedIngredients` (strict purchasable form) and structured `annotatedPreparationSteps`.
- **AI Draft Generation:**
  - Prompts refined to ensure `singleRecipeDraftToolSchema` outputs a simple `title: string`.
  - Prompts for `preparationText` and `instructionsText` updated for clarity and consistent multi-line formatting (no explicit numbering for instructions).
- **Frontend AI Integration:**
  - `RecipeEdit.tsx` now updates `formState.aiAnalyzedTitle` with `titleString` from DNA and populates `formState.aiConceptualTags`.
  - Implemented enhanced client-side deduplication of user custom tags (`formState.tagsText`) against AI conceptual tags, handling simple plurals and variations.
  - `AIChatPanel.tsx` updated to display AI Processed Title and AI Conceptual Tags during the 'polishing' phase (other DNA metrics display deferred for now).
  - Added `pendingAiSuggestions` state and related actions/selectors to `aiInterfaceStore.ts` in preparation for AI Assessor polishing suggestions.

### Bug Fixes & Refinements:
- Resolved Gemini SDK schema validation errors (`parameters.required[X]: property is not defined`) by ensuring consistency between schema properties and required arrays.
- Fixed React error "Objects are not valid as a React child" by correctly accessing string properties from the structured `aiAnalyzedTitle` object for display.
- Addressed potential infinite loop in `RecipeEdit.tsx` `useEffect` for DNA processing by refining dependency array and conditional updates.
- Ensured UUIDs are correctly injected by the backend into all line items within `annotatedIngredients`, `annotatedPreparationSteps`, and `annotatedInstructionSteps` in the DNA.

### Schema & Type Changes:
- `singleRecipeDraftToolSchema`: Title property simplified to a single string.
- `recipeDNADetailToolSchema`: 
  - `aiAnalyzedTitle` converted to a nested object with structural components.
  - `annotatedPreparationSteps` items expanded with structured fields.
  - `userTagAnalysis` property removed.
- TypeScript types (`RecipeDraftVariation`, `CurrentRecipeDraftPayload`, `RecipeDNADetail`, `AnnotatedPreparationStep`, `AnalyzedTitleObject`) updated to reflect all schema changes and data flow adjustments.
2024-05-22
feat(ai): Implement Phase 1 Recipe DNA generation and display

- Added `/api/ai/generate-recipe-dna` endpoint to produce detailed, structured Recipe DNA using Gemini with a custom tool schema.
- Updated types: `RecipeDNADetail`, `CurrentRecipeDraftPayload` defined. `RecipeFormState` and `Recipe` type now include `aiAnalyzedTitle` and `aiConceptualTags`. `Recipe` type also includes `searchableTags`.
- `useRecipeAiOrchestrator`:
    - `initiateDnaGeneration` now calls the live DNA API.
    - On success, populates `aiInterfaceStore.currentRecipeDna`.
    - Updates `RecipeFormState` with `aiAnalyzedTitle` and `aiConceptualTags` from the DNA.
- `aiInterfaceStore`: Added state for `currentRecipeDna` and action `setActualRecipeDna`. Refined `setDnaReadyForRecipe` for phase/state management.
- `RecipeEdit.tsx`:
    - `handleSubmit` now calculates and saves `searchableTags` (merged user & AI tags) and persists `aiAnalyzedTitle` & `aiConceptualTags`.
    - Displays AI-generated `aiConceptualTags` in the main form after DNA processing.
    - Passes `currentRecipeDna` and other relevant form data to `AIChatPanel`.
- `AIChatPanel.tsx`:
    - When `recipeAiPhase` is 'polishing', now displays key insights from `RecipeDNADetail` including: AI analyzed title, AI conceptual tags, analysis of user's tags, AI estimated cook time/servings, and AI overall summary.
- Successfully tested end-to-end flow for draft generation followed by DNA generation, storage, and display of insights.
 2024-05-21
feat: Implement Phase 1 AI Draft Generation UI and State Flow

- Added `aiInterfaceStore.ts` (Zustand) for managing AI chat panel visibility, context, active recipe AI state (ID, phase, DNA readiness), and related actions.
- Modified `userStore.ts` to include a global `isAiAssistEnabled` setting.
- Created `AIFab.tsx` component to trigger AI panel; FAB appearance and actions are context-aware (login status, AI enabled, current AI phase).
- Refactored `page.tsx` (RecipeSnapContainer) to use global AI states from stores and render the new `AIFab`.
- Significantly updated `RecipeEdit.tsx`:
    - Subscribes to `aiInterfaceStore` for panel state and AI phase.
    - Manages AI context by setting the current recipe ID in `aiInterfaceStore`.
    - Implements a 2-column layout to display `AIChatPanel` alongside the form.
    - Contains handlers (`handleGenerateSingleDraftVariation`, `handleInitiateDnaGeneration` (mocked)) for Phase 1 AI actions.
    - Passes necessary props and callbacks to `AIChatPanel`.
- Created `AIChatPanel.tsx` component:
    - Renders its own UI shell (header, close button).
    - Dynamically displays content based on `currentPhase` prop (draft options, DNA trigger, loading states, status messages).
    - Calls back to `RecipeEdit.tsx` to initiate AI actions.
- Refactored API route `/api/ai/analyze/route.ts` to `/api/ai/generate-single-draft-variation/route.ts` for generating single, specific recipe drafts, including a new `singleRecipeDraftToolSchema`.
- Fixed various TypeScript errors, UI rendering bugs (duplicate panels), and state synchronization issues to achieve correct initial UI flow for draft selection.
- Removed old `useRecipeAiAssist` onBlur functionality, centralizing AI draft initiation via the new panel.
2024-05-20
feat: Implement initial data seeding for recipes and title autocomplete
- Added logic to `page.tsx` to populate local IndexedDB with initial sample recipes and their titles for autocomplete on first app load.
- Ensured seeding occurs only once per new user/browser via a localStorage flag.
- Refined `recipeStore.ts` to remove conflicting initial data logic, making `page.tsx` the authority for seeding.

feat: Implement Phase 0 - Client-Side Title Autocomplete & Mocked AI Tag Generation
- `RecipeEdit.tsx` now features title autocomplete querying local cache (seeded by initial data).
- Selecting an autocomplete suggestion or blurring the title input (when AI Assist is ON) triggers a call to a new (currently mocked) backend API `/api/ai/generate-tags`.
- `tagsText` field in `RecipeEdit.tsx` is populated with tags from the mock API.
- All Phase 0 AI features are controlled by the main "AI Assist" toggle.

fix: Resolved React duplicate key warnings during initial data seeding
- Corrected data flow to prevent temporary duplication of initial recipes in Zustand store, which caused React key errors in lists.

design: Refined multi-phase AI recipe assistance strategy
- Phase 0: Title finalization with client-side autocomplete.
- Phase 1, Stage 1: AI Fab reveals options (Basic, Pantry, User Preference, Pantry+User Pref) to generate a single, context-specific recipe draft (textual description, ingredients, instructions) and conceptual tags. This draft populates the form.
- Phase 1, Stage 2: Recipe DNA is generated for the chosen/applied draft and stored. AI Fab indicates "DNA Ready."
- Phase 2: "DNA Ready" AI Fab opens an interactive chat panel for DNA-assisted, line-by-line recipe polishing.

feat(backend): Implement API for generating contextual recipe draft variations
- Created `/api/ai/generate-single-draft-variation/route.ts` (or refactored existing).
- Designed `singleRecipeDraftToolSchema` for Gemini to output structured draft content (conceptual tags, title, desc, ingredients text, instructions text) for one variation.
- Implemented prompt logic to generate Basic, Pantry Optimized, or User Preference focused drafts based on client request.

refactor: Clarified tag system with `aiConceptualTags` (read-only, AI-generated) and user-editable tags.
 2024-05-19
feat: Solidify Comprehensive User Profile & Auth Flow

- Defined canonical user profile types (`ComprehensiveUserProfile`, `UserPreferences`, etc.) in `src/types/index.ts`.
- Refactored `userStore.ts` to manage `ComprehensiveUserProfile`, `currentUser`, and handle localStorage hydration with SSR safety.
- Extensively refactored `AuthContext.tsx`:
    - Orchestrates fetching and creation of `ComprehensiveUserProfile` in Firestore.
    - Correctly populates `userStore` with profile data, respecting store hydration.
    - Implemented robust logic for new user profile document creation, including data cleaning (undefined to null) and server-set timestamps, resolving previous `setDoc` errors.
    - Resolved infinite loop during new user sign-up by implementing a `useRef` flag to manage profile creation attempts within snapshot listeners.
    - Establishes a default guest profile on logout.
    - Improved listener cleanup and `useEffect` stability.
- Updated Firestore security rules for `/users/{userId}` (`allow create`, `allow update`) to align with `ComprehensiveUserProfile` structure, data types, and timestamp handling (server timestamps for create/update). Validated rules in Playground.
- Drafted `USER_PROFILE_ARCHITECTURE.md` for user data flow and structure.
2025-05-17
feat: Implement robust Recipe DNA generation API

- Add new API endpoint `/api/ai/generate-recipe-dna` for comprehensive recipe analysis.
- Utilize Gemini 1.5 Pro with Tool Calling for structured `RecipeDNADetail` output.
- Define detailed JSON schema (`recipeDNADetailToolSchema`) for AI tool, including fields for annotated ingredients (with descriptors), annotated instructions, AI conceptual tags, user tag analysis, and recipe estimates.
- Implement comprehensive prompt engineering for accurate parsing and desired output style, particularly for foundational `aiConceptualTags` and ingredient `descriptors`.
- Successfully test API across diverse recipe types (soup, baking, stir-fry, no-cook, grouped ingredients), validating parsing accuracy for various structures and unit preferences.

fix: Resolve server-side and client-side initialization errors

- Implement `safeLocalStorage` wrapper in `userStore.ts` to prevent `localStorage` access errors during SSR.
- Standardize AI client initialization using a shared `getGenAIClient` and `GOOGLE_GENAI_API_KEY` environment variable.
- Correct `onRehydrateStorage` in `userStore.ts` to prevent "Cannot access 'useUserStore' before initialization" error by using the passed store instance.
- Align function signatures and type definitions for user profile data handling (`initializeUserProfileDataIfNeeded`, `getMvpUserProfileData`) to resolve TypeScript errors.
- Address API client (Postman) configuration issues (port, URL, headers) for successful backend testing.

refactor: Plan for user profile data model consolidation

- Strategize to revert UI components to a stable state to address client-side infinite loops.
- Outline plan to refactor user profile data:
  - Define `ComprehensiveUserProfile` in `aiTypes.ts` as the single source of truth.
  - Update `userStore.ts` to use `ComprehensiveUserProfile` for `state.profileData`.
  - Update `AuthContext.tsx` to fetch and populate the full `ComprehensiveUserProfile` into the store.
- This refactor will create a stable data foundation for subsequent AI feature integration in UI components like `RecipeEdit.tsx`.
2025-05-16
feat(ai): Implement structured title generation API (Phase 1)

- Added `StructuredTitleSuggestion` type for returning detailed title components.
- Centralized culinary keywords (methods, adjectives, dish categories, common ingredients) into `src/lib/culinaryData.ts`.
- Enhanced `detectCookingInfo` utility in `generate-recipe-field` API to identify dish categories and utilize centralized culinary data for improved recipe analysis.
- Overhauled `buildGenerateFieldPrompt` for `fieldName: "title"`:
    - Instructs LLM to output an array of `StructuredTitleSuggestion` objects.
    - Provides detailed guidance on deriving `methodStyle` (method or category), `mainDishComponent`, and optional `adjective`.
    - Incorporates hints from `detectCookingInfo` and establishes a clear hierarchy for contextual influence.
- Updated the `POST` handler in `generate-recipe-field` API to correctly parse and validate the new `StructuredTitleSuggestion[]` response for titles.
- Successfully tested structured title generation across multiple recipe types (soup, roasted dishes, salads, desserts), confirming accurate component extraction and high-quality title strings.
- Added placeholder logic for future `conceptualTags` generation.

2025-05-15
feat(api): Implement /api/ai/generate-recipe-field endpoint for contextual recipe field suggestions
- API route created using Next.js App Router structure.
- Supports suggestions for fields: title, description, ingredients, preparation, instructions, tags.
- Accepts current recipe draft, title, user profile data (pantry, preferences, unit system), and suggestion context (Basic, PantryOptimized, UserPreferenceEnhanced) as input.
- Dynamically builds prompts for Gemini 1.5 Pro, considering existing field content, servings, and user context.
- For 'ingredients' field, prompts AI to return structured data (list of ingredient objects with name, US/Metric units, size_modifier, prep_notes). Defaults to requesting dual US/Metric units.
- For other fields, prompts AI to return an array of text suggestions.
- Includes server-side mock profile override for testing via 'X-Use-Mock-Profile' header.
- Successfully tested with Postman, demonstrating high-quality structured output for ingredients.

feat(api): Implement /api/ai/seed-recipe-idea endpoint for title suggestion cache
- API route created using Next.js App Router structure.
- Accepts reference recipe title, tags, and user profile data.
- Calls Gemini LLM to generate complementary recipe titles.
- Tested via temporary button in RecipeEdit, successfully populates client-side IndexedDB cache.

feat(cache): Implement IndexedDB titleSuggestionsCache for recipe title auto-complete
- Defined schema and config in titleCacheConfig.ts.
- Implemented utility functions (open, add, query, increment selection) using 'idb' library.

fix(api): Corrected API route structure from Pages Router to App Router for /seed-recipe-idea, resolving 405 errors.
fix(client): Resolved TypeScript errors in RecipeEdit.tsx related to shared types and toast component usage.
fix(client): Addressed runtime errors in RecipeEdit.tsx by refactoring component state and handlers during AI feature testing.
chore(types): Created shared aiTypes.ts for AI API request/response interfaces (FieldName, SuggestionContext, UserProfileDataPayload, etc.).
chore(functions): Added missing Firebase Callable Functions (getUserAiAssistUsage, getUserOcrUsage) to resolve client-side CORS errors.
2025-05-13
### üêõ Bug Fixes & Resilience (Planned & Confirmed by User)

- **OCR API JSON Parsing:** Implemented a `cleanJsonString` utility in the `/api/ai/ocr` route to handle and remove trailing commas from AI-generated JSON, preventing parsing errors.
- **OCR Credit Refund Flow:**
    - Diagnosed that the `refundOcrCredit` Cloud Function was missing.
    - Designed and planned the `refundOcrCredit` v2 Firebase Function, including audit logging.
    - Confirmed (by user) that after implementation and deployment, the refund mechanism works correctly when triggered by a simulated client-side error.

### üõ†Ô∏è UI/UX Improvements

- **`OcrUploader.tsx` Enhancements:**
    - Now correctly handles "no credits" scenarios by disabling upload functionality and displaying clear messages.
    - Manages "not logged in" state by prompting users to sign in and appropriately disabling features.
- **`page.tsx` (Recipe List Update):** Integrated `fetchRecipes` into `handleOcrScanSuccess` to ensure the main recipe list updates immediately after an OCR draft is saved locally.
2025-05-11
### Feature: OCR Quota System & Processing Flow Foundation (Client-Side)

- **User Quota Management (`AuthContext`, `UserStore`):**
    - Implemented `UserStore` with Zustand `persist` middleware to cache OCR credits remaining, monthly limit, and last fetch timestamp in `localStorage`, enabling offline UI display of last known quota.
    - Refined `AuthContext` to:
        - Fetch authoritative quota via `getUserOcrUsage` Cloud Function on user login if local cache is empty.
        - Handle network errors during quota fetch gracefully by displaying persisted data and setting an error state, rather than resetting quota to zero.
        - Establish a Firestore `onSnapshot` listener for the user's monthly usage document (`users/{userId}/usage/{currentMonth}`).
        - The `onSnapshot` callback now robustly updates both `ocrCreditsRemaining` (based on `ocrScanCount`) and `ocrMonthlyLimit` (if the `limit` field changes in the snapshot) in the `UserStore`.
        - Correctly clears user-specific quota data from `UserStore` and `localStorage` on logout.
- **Firestore:**
    - Updated security rules to grant users read access to their own main user document (`/users/{userId}`) and their specific monthly usage documents (`/users/{userId}/usage/{usageDocId}`).
- **OCR Processing Hook (`useOcrProcessor` - Drafted):**
    - Designed the hook to manage the end-to-end OCR process.
    - Includes client-side pre-flight check of `ocrCreditsRemaining` from `UserStore`.
    - Calls `attemptAndIncrementUsage` Cloud Function for server-side credit debit.
    - Calls the `/api/ai/ocr` Next.js API route.
    - Prepares OCR data to match the application's `Recipe` interface (including `_isFromOcr: true`).
    - Saves the initial OCR draft to local IndexedDB via the `useRecipeStore.addRecipe` action (ensuring optimistic UI updates).
    - Includes logic to call `refundOcrCredit` Cloud Function if the OCR API call fails after a credit has been successfully debited.
    - Manages `isLoading` and `error` states for UI feedback.
- **UI Components (Drafted & Integrated for OCR Flow):**
    - `OcrUploader.tsx`: Component to handle file input, display OCR processing state (loading, error, credits remaining via `useOcrProcessor`), and trigger the processing.
    - `AddRecipeSheet.tsx`: Modified to trigger an OCR modal (controlled by `page.tsx`) when "Scan from Image" is selected.
    - `RecipeList.tsx`: Modified to include a "Scan Recipe" button that displays available credits and also triggers the OCR modal.
    - `page.tsx`:
        - Manages the visibility of the OCR modal containing `OcrUploader`.
        - Implements `handleOcrScanSuccess` to receive the locally saved OCR draft and navigate to `RecipeEdit`.
        - Simplified `handleSaveRecipe` to remove upfront credit deduction logic (now handled by `useOcrProcessor`); it now focuses on updating existing OCR drafts or adding new manual recipes.
- **Bug Fixes & Refinements:**
    - Resolved various TypeScript errors related to `HttpsCallableResult` type inference and component prop mismatches.
    - Added `_isFromOcr` flag to the core `Recipe` interface.
    - Corrected Firestore security rule paths and permissions.
- **Identified Next Steps:**
    - Full implementation and testing of `useOcrProcessor` and `OcrUploader`.
    - Finalizing `page.tsx` integration and `handleSaveRecipe` simplification.
    - Addressing the CORS issue for the `refundOcrCredit` Cloud Function.
2025-05-10
### Fixed
- Resolved IndexedDB error "keyPath did not yield a value" during new recipe creation by ensuring a local ID is generated before saving to the local database.
- Corrected HTML nesting issue in RecipeEdit component causing console errors by removing a conflicting Tooltip.
- Addressed Firestore data inconsistency with duplicate ocrScanCount fields.

### Changed
- Refined OCR processing flow to support different models for usage increment timing (upfront vs. on explicit save).
- (On debug branch) Reverted OCR handling logic in main page component to a pre-hook state for focused debugging of save issues.

### Added
- (Conceptual) Planned for `requestOcrUsageCredit` Cloud Function and client-side logic for users to report OCR API failures after usage increment for manual review.
- (Cloud Functions) Successfully deployed `getUserOcrUsage` and `attemptAndIncrementUsage` functions.
2025-05-09
### Fixed
- Resolved critical client-side infinite loop in OCR usage fetching (`useOcrHandler.ts`) caused by incorrect `useEffect` dependencies, significantly reducing Firebase Function invocations and Firestore reads.
- Corrected TypeScript errors related to variable declaration order and scope in `page.tsx` and `useOcrHandler.ts`.
- Stabilized Firebase Functions service initialization within `useOcrHandler.ts` by switching to a globally initialized instance from `config.ts`.

### Changed
- Refactored OCR initiation logic from `page.tsx` into a dedicated custom hook `useOcrHandler.ts` for better separation of concerns.
- Deployed `getUserOcrUsage` v2 Cloud Function to fetch user's OCR scan count and limits.
- Updated `functions/index.js` to correctly export functions from newly created `usageCapFunctions.js`.

### Added
- Initial client-side logic in `useOcrHandler.ts` to call `getUserOcrUsage` and manage loading/error states for OCR usage data.
- Manual Firestore setup for `users/{uid}/usage/{YYYY-MM}` to store `ocrScanCount`.
- (Conceptual) Planned for local-first OCR counter display using IndexedDB to minimize initial Firebase calls.

2025-05-08
feat(admin): Implement admin user profile management

- Add callable Cloud Function `getUserProfileAdmin` to fetch user profiles from Firestore.
- Add callable Cloud Function `updateUserAdmin` to update user profiles (tier, tokens, notes) with input validation, sanitization, and audit logging.
- Create `firestoreUtils.js` with `getUserDocument` and `updateUserDocument` helpers.
- Create `actionLogUtils.js` with `createAuditLog` helper for logging admin actions to Firestore.
- Update Admin Page UI (`/admin`) to display fetched user profile details upon selection from the user list.
- Implement edit-in-place functionality on Admin Page for selected user profiles (Tier, Tokens, Notes) with Save/Cancel actions calling `updateUserAdmin`.
- Add back button navigation to Admin Page.
- Fix various Cloud Function deployment issues (linting, imports, parsing).
- Refactor Cloud Function region handling for client-side calls.
- Ensure Firestore `users` collection exists for testing profile management.
2025-05-07
feat: Implement Admin User Designation via Firebase Custom Claims
- Added Firebase Cloud Function (`processAdminClaimRequest`) triggered by Firestore writes to `adminClaimRequests` collection to set/remove `admin:true` custom claims on users.
- Implemented `adminActionLogs` Firestore collection for auditing administrative changes made by the Cloud Function.
- Upgraded Firebase project to Blaze plan to support Cloud Function deployment.
- Updated `AuthContext` to read custom claims from user ID tokens and expose an `isAdmin` boolean state.
- Modified `AppHeader` to display an "Admin" title variant and a conditional admin panel icon/link for users with the `admin:true` claim.
- Iteratively debugged and resolved Cloud Function deployment errors, including ESLint issues, SDK syntax errors for v2 Firestore triggers, and Eventarc permission propagation delays.

2025-05-04
feat: Implement Firestore cloud save for recipes when logged in.
feat: Add data cleaning to convert undefined optional fields to null before Firestore writes.
feat: Refactor recipe store to use separate 'isSaving' state for add/update operations.
feat: Implement post-save alert feedback (Option 3).
feat: Add 'Clear Form' button to Recipe Edit view.
feat: Refactor AI blur logic into reusable 'useRecipeAiAssist' custom hook.
fix: Resolve Firestore 'permission-denied' error by correcting security rules and data preparation.
fix: Correct multiple TypeScript errors related to props and state management in page and RecipeEdit components.
fix: Correct 'handleInputChange' calling convention in RecipeEdit.
chore: Configure local Git user identity.

2024-05-02
feat: Implement Firebase Authentication with Google Sign-In context provider.
feat: Add Firestore database service (firestoreService.ts) for recipe CRUD operations.
feat: Implement Repository pattern (recipeRepository.ts) to abstract data source logic.
feat: Integrate Zustand (recipeStore.ts) for centralized recipe state management.
refactor: Update main page (page.tsx) to use Zustand store for state and actions.
refactor: Update Settings view to use AuthContext.
fix: Add data cleaning in firestoreService.ts to remove undefined values before writes.
fix: Correct various TypeScript and syntax errors in multiple components.
fix: Update Firestore security rules to allow null values for optional fields.
feat: Add conditional "Save to Cloud" button in RecipeDetail for testing Firestore writes.
chore: Attempt Firebase Emulator setup and troubleshoot environment issues (Java, Ports, Nix).
chore: Revert Firebase config to use live backend due to emulator/login constraints.

2025/05/01
- **feat(auth):**¬†Implement Firebase Google Authentication using¬†signInWithPopup.
- **feat(auth):**¬†Add global authentication state management via React Context (AuthContext).
- **feat(ui):**¬†Integrate user login status, Sign In/Sign Out buttons into App Header.
- **feat(ui):**¬†Add 'Organizer' tab and placeholder view to Bottom Navigation.
- **feat(ui):**¬†Display loading indicator during background AI operations near AI Chat FAB.
- **fix(auth):**¬†Resolve Firebase/GCP configuration mismatch preventing Google Sign-in.
- **fix(auth):**¬†Ensure correct OAuth Client ID and Redirect URI are configured.
- **fix(ui):**¬†Keep AI Chat FAB visible on Edit/Detail views.
- **fix(dev):**¬†Change development server port to avoid EADDRINUSE conflict.
- **fix(nav):**¬†Correct navigation logic for the new 'Organizer' tab.
- **refactor(auth):**¬†Lift AI analysis loading state (isAiLoading) to parent component.
